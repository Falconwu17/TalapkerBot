CREATE TABLE IF NOT EXISTS content (
    id SERIAL PRIMARY KEY,
    slug TEXT NOT NULL,
    lang TEXT NOT NULL,
    title TEXT NOT NULL,
    body TEXT NOT NULL,
    UNIQUE(slug, lang)
    );
INSERT INTO content (slug, lang, title, body) VALUES
                                                  ('programs','ru','–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã',
                                                   '–°–ø–∏—Å–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º: –ê–≥—Ä–æ–Ω–æ–º–∏—è, –í–µ—Ç–µ—Ä–∏–Ω–∞—Ä–∏—è, –ò–Ω–∂.-—Ç–µ—Ö–Ω., IT –∏ –¥—Ä. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏: —Å–∞–π—Ç/–ø—Ä–∏—ë–º–∫–∞.'),
                                                  ('documents','ru','–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è',
                                                   '–ü–∞—Å–ø–æ—Ä—Ç/ID, –ê—Ç—Ç–µ—Å—Ç–∞—Ç, –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ï–ù–¢, –§–æ—Ç–æ 3x4, –ú–µ–¥.—Å–ø—Ä–∞–≤–∫–∞ 075-–£, –ó–∞—è–≤–ª–µ–Ω–∏–µ, –∏ —Ç.–¥.'),
                                                  ('grants','ru','–ì—Ä–∞–Ω—Ç—ã',
                                                   '–ì—Ä–∞–Ω—Ç—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ï–ù–¢/–∫–≤–æ—Ç–∞–º. –°—Ä–æ–∫–∏ –ø–æ–¥–∞—á–∏ –∏ –ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –±–∞–ª–ª—ã ‚Äî –≤ –ø—Ä–∏—ë–º–∫–µ.'),
                                                  ('dorm','ru','–û–±—â–µ–∂–∏—Ç–∏–µ',
                                                   '–ú–µ—Å—Ç–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ: –∏–Ω–æ–≥–æ—Ä–æ–¥–Ω–∏–µ/–ª—å–≥–æ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –£–∑–Ω–∞–π—Ç–µ –æ—á–µ—Ä–µ–¥–Ω–æ—Å—Ç—å.'),
                                                  ('programs','kz','–ë—ñ–ª—ñ–º –±–µ—Ä—É –±–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—Ä—ã',
                                                   '–ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—Ä —Ç—ñ–∑—ñ–º—ñ: –ê–≥—Ä–æ–Ω–æ–º–∏—è, –í–µ—Ç–µ—Ä–∏–Ω–∞—Ä–∏—è, –ò–Ω–∂.-—Ç–µ—Ö., IT –∂”ô–Ω–µ —Ç.–±. –¢–æ–ª—ã“ì—ã—Ä–∞“õ: —Å–∞–π—Ç/“õ–∞–±—ã–ª–¥–∞—É.'),
                                                  ('documents','kz','“ö“±–∂–∞—Ç—Ç–∞—Ä —Ç—ñ–∑—ñ–º—ñ',
                                                   '–ñ–µ–∫–µ –∫—É”ô–ª—ñ–∫, –ê—Ç—Ç–µ—Å—Ç–∞—Ç, “∞–ë–¢ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, 3x4 —Ñ–æ—Ç–æ, 075-–£ –º–µ–¥–∞–Ω—ã“õ—Ç–∞–º–∞, ”®—Ç—ñ–Ω—ñ—à –∂”ô–Ω–µ —Ç.–±.'),
                                                  ('grants','kz','–ì—Ä–∞–Ω—Ç—Ç–∞—Ä',
                                                   '–ì—Ä–∞–Ω—Ç—Ç–∞—Ä “∞–ë–¢ –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä—ñ/–∫–≤–æ—Ç–∞–ª–∞—Ä –±–æ–π—ã–Ω—à–∞ –±”©–ª—ñ–Ω–µ–¥—ñ. ”®—Ç—ñ–Ω—ñ—Å –º–µ—Ä–∑—ñ–º–¥–µ—Ä—ñ –º–µ–Ω ”©—Ç—É –±–∞–ª–¥–∞—Ä—ã ‚Äî “õ–∞–±—ã–ª–¥–∞—É–¥–∞.'),
                                                  ('dorm','kz','–ñ–∞—Ç–∞“õ—Ö–∞–Ω–∞',
                                                   '–û—Ä—ã–Ω–¥–∞—Ä –±–∞—Å—ã–º–¥—ã“õ–ø–µ–Ω –±–µ—Ä—ñ–ª–µ–¥—ñ: “õ–∞–ª–∞–¥–∞–Ω —Ç—ã—Å/–∂–µ“£—ñ–ª–¥—ñ–∫ —Å–∞–Ω–∞—Ç—Ç–∞—Ä—ã. –ö–µ–∑–µ–∫—Ç—ñ–ª—ñ–∫—Ç—ñ –Ω–∞“õ—Ç—ã–ª–∞“£—ã–∑.')
ON CONFLICT DO NOTHING;
INSERT INTO content (slug, lang, title, body) VALUES
                                                  ('why-wkatu','ru','–ü–æ—á–µ–º—É WKATU','‚Ä¢ –ü—Ä–∞–∫—Ç–∏–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ\n‚Ä¢ –°–∏–ª—å–Ω—ã–µ –∞–≥—Ä–æ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n‚Ä¢ –°—Ç–∏–ø–µ–Ω–¥–∏–∏ –∏ –≥—Ä–∞–Ω—Ç–æ–≤—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã\n‚Ä¢ –û–±—â–µ–∂–∏—Ç–∏–µ –∏ —Å—Ç—É–¥–∫–ª—É–±—ã\n‚Ä¢ –ü–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–∞ —Å —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è–º–∏'),
                                                  ('why-wkatu','kz','–ù–µ–≥–µ WKATU','‚Ä¢ –¢”ô–∂—ñ—Ä–∏–±–µ–≥–µ –±–∞“ì—ã—Ç—Ç–∞–ª“ì–∞–Ω –æ“õ—É\n‚Ä¢ –ö“Ø—à—Ç—ñ –∞–≥—Ä–æ –∂”ô–Ω–µ –∏–Ω–∂–µ–Ω–µ—Ä–ª—ñ–∫ –±–∞“ì—ã—Ç—Ç–∞—Ä\n‚Ä¢ –°—Ç–∏–ø–µ–Ω–¥–∏—è–ª–∞—Ä –º–µ–Ω –≥—Ä–∞–Ω—Ç—Ç–∞—Ä\n‚Ä¢ –ñ–∞—Ç–∞“õ—Ö–∞–Ω–∞ –º–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç—Ç—ñ–∫ –∫–ª—É–±—Ç–∞—Ä\n‚Ä¢ –ñ“±–º—ã—Å –±–µ—Ä—É—à—ñ–ª–µ—Ä–º–µ–Ω ”ô—Ä—ñ–ø—Ç–µ—Å—Ç—ñ–∫'),

                                                  ('campus','ru','–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è –∂–∏–∑–Ω—å –≤ WKATU','–ö–ª—É–±—ã –∏ —Å–µ–∫—Ü–∏–∏: IT, –∞–≥—Ä–æ—Ç–µ—Ö, —Å–ø–æ—Ä—Ç, –º–µ–¥–∏–∞. –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤–æ, —Ö–∞–∫–∞—Ç–æ–Ω—ã. –°–ø–æ—Ä—Ç–∑–∞–ª –∏ —Å–µ–∫—Ü–∏–∏. –£–∑–Ω–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ ‚Äî —É —Å—Ç—É–¥—Å–æ–≤–µ—Ç–∞.'),
                                                  ('campus','kz','WKATU —Å—Ç—É–¥–µ–Ω—Ç—Ç—ñ–∫ ”©–º—ñ—Ä—ñ','–ö–ª—É–±—Ç–∞—Ä –º–µ–Ω —Å–µ–∫—Ü–∏—è–ª–∞—Ä: IT, –∞–≥—Ä–æ—Ç–µ—Ö, —Å–ø–æ—Ä—Ç, –º–µ–¥–∏–∞. –¢“±—Ä–∞“õ—Ç—ã —ñ—Å-—à–∞—Ä–∞–ª–∞—Ä, –≤–æ–ª–æ–Ω—Ç—ë—Ä–ª—ñ–∫, —Ö–∞–∫–∞—Ç–æ–Ω–¥–∞—Ä. –°–ø–æ—Ä—Ç–∑–∞–ª –∂”ô–Ω–µ —Å–µ–∫—Ü–∏—è–ª–∞—Ä. –ê–∫—Ç—É–∞–ª–¥—ã ‚Äî —Å—Ç—É–¥–µ–Ω—Ç—Ç–µ—Ä –∫–µ“£–µ—Å—ñ–Ω–¥–µ.');


CREATE TABLE "—É–∑–ª—ã_–º–µ–Ω—é" (
    id            BIGSERIAL PRIMARY KEY,
    "code"        TEXT UNIQUE NOT NULL,
    "title_key"   TEXT NOT NULL,
    "slug"        TEXT,
    "parent_id"   BIGINT REFERENCES "—É–∑–ª—ã_–º–µ–Ω—é"(id) ON DELETE SET NULL,
    "order"       INT NOT NULL DEFAULT 0,
    "active"      BOOLEAN NOT NULL DEFAULT TRUE
);

CREATE TABLE "–∫–Ω–æ–ø–∫–∏" (
    id BIGSERIAL PRIMARY KEY,
    node_id BIGINT NOT NULL REFERENCES —É–∑–ª—ã_–º–µ–Ω—é(id) ON DELETE CASCADE,
    "text_key" TEXT NOT NULL,
    "next_node_id"  BIGINT REFERENCES "—É–∑–ª—ã_–º–µ–Ω—é"(id) ON DELETE SET NULL,
    "order" INT NOT NULL DEFAULT 0
);

CREATE TABLE "–ø–µ—Ä–µ–≤–æ–¥—ã" (
    id      BIGSERIAL PRIMARY KEY,
    "lang"  TEXT NOT NULL,
    "key"   TEXT NOT NULL,
    "text"  TEXT NOT NULL,
    UNIQUE("lang","key")
);

CREATE INDEX ON "—É–∑–ª—ã_–º–µ–Ω—é"("parent_id");
CREATE INDEX ON "–∫–Ω–æ–ø–∫–∏"("node_id");
CREATE INDEX ON "–ø–µ—Ä–µ–≤–æ–¥—ã"("key","lang");

-- 02_seed.sql
INSERT INTO "—É–∑–ª—ã_–º–µ–Ω—é"("code","title_key","order")
VALUES
    ('main','title.main',1),
    ('grants','title.grants',2),
    ('documents','title.documents',3),
    ('programs','title.programs',4),
    ('dorm','title.dorm',5);

UPDATE "—É–∑–ª—ã_–º–µ–Ω—é" SET "slug"='grants'    WHERE "code"='grants';
UPDATE "—É–∑–ª—ã_–º–µ–Ω—é" SET "slug"='documents' WHERE "code"='documents';
UPDATE "—É–∑–ª—ã_–º–µ–Ω—é" SET "slug"='programs'  WHERE "code"='programs';
UPDATE "—É–∑–ª—ã_–º–µ–Ω—é" SET "slug"='dorm'      WHERE "code"='dorm';

INSERT INTO "–∫–Ω–æ–ø–∫–∏"("node_id","text_key","next_node_id","order")
SELECT m.id, s.key, n.id, s.ord
FROM (VALUES
          ('btn.programs','programs',1),
          ('btn.documents','documents',2),
          ('btn.grants','grants',3),
          ('btn.dorm','dorm',4)
     ) AS s(key,next,ord)
         JOIN "—É–∑–ª—ã_–º–µ–Ω—é" m ON m."code"='main'
         JOIN "—É–∑–ª—ã_–º–µ–Ω—é" n ON n."code"=s.next;

-- –ø–µ—Ä–µ–≤–æ–¥—ã (–ø—Ä–∏–º–µ—Ä)
INSERT INTO "–ø–µ—Ä–µ–≤–æ–¥—ã"("lang","key","text") VALUES
                                                ('ru','title.main','–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é'),
                                                ('kz','title.main','–ù–µ–≥—ñ–∑–≥—ñ –º”ô–∑—ñ—Ä'),

                                                ('ru','title.programs','–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã'),
                                                ('kz','title.programs','–ë—ñ–ª—ñ–º –±–µ—Ä—É –±–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—Ä—ã'),

                                                ('ru','title.documents','–î–æ–∫—É–º–µ–Ω—Ç—ã'),
                                                ('kz','title.documents','“ö“±–∂–∞—Ç—Ç–∞—Ä'),

                                                ('ru','title.grants','–ì—Ä–∞–Ω—Ç—ã'),
                                                ('kz','title.grants','–ì—Ä–∞–Ω—Ç—Ç–∞—Ä'),

                                                ('ru','title.dorm','–û–±—â–µ–∂–∏—Ç–∏–µ'),
                                                ('kz','title.dorm','–ñ–∞—Ç–∞“õ—Ö–∞–Ω–∞'),

                                                ('ru','btn.programs','üéì –ü—Ä–æ–≥—Ä–∞–º–º—ã'),
                                                ('kz','btn.programs','üéì –ë–∞“ì–¥–∞—Ä–ª–∞–º–∞–ª–∞—Ä'),

                                                ('ru','btn.documents','üìë –î–æ–∫—É–º–µ–Ω—Ç—ã'),
                                                ('kz','btn.documents','üìë “ö“±–∂–∞—Ç—Ç–∞—Ä'),

                                                ('ru','btn.grants','üéÅ –ì—Ä–∞–Ω—Ç—ã'),
                                                ('kz','btn.grants','üéÅ –ì—Ä–∞–Ω—Ç—Ç–∞—Ä'),

                                                ('ru','btn.dorm','üè† –û–±—â–µ–∂–∏—Ç–∏–µ'),
                                                ('kz','btn.dorm','üè† –ñ–∞—Ç–∞“õ—Ö–∞–Ω–∞');
